var s=(r,e,t)=>new Promise((c,i)=>{var u=o=>{try{n(t.next(o))}catch(d){i(d)}},a=o=>{try{n(t.throw(o))}catch(d){i(d)}},n=o=>o.done?c(o.value):Promise.resolve(o.value).then(u,a);n((t=t.apply(r,e)).next())});import{getDiscount as l}from"./utils.js";const f="http://157.201.228.93:2992/";function m(r){const e=r.Colors.map(t=>t.ColorName);return e.join(" + ")}function p(r,e){let t=localStorage.getItem("so-cart");t==null?t=[]:t=JSON.parse(t);let c=t.findIndex(i=>i.Id===e.Id);c===-1&&(e.qty=0,c=t.length,t.push(e)),t[c].qty+=1,localStorage.setItem(r,JSON.stringify(t))}function h(r){r.classList.remove("animate")}function g(){let r=0,e=S("so-cart");return e.forEach(t=>{r+=parseInt(t.qty)}),r}function S(r){return JSON.parse(localStorage.getItem(r))}export default class y{constructor(e,t){this.productId=e,this.product={},this.dataSource=t}init(){return s(this,null,function*(){this.product=yield this.dataSource.findProductById(this.productId),this.renderProductDetails(),document.getElementById("addToCart").addEventListener("click",this.addToCart.bind(this))})}addToCart(e){p("so-cart",this.product);let t=document.getElementById("cart-icon");t.classList.add("animate"),setTimeout(function(){h(t)},1e3),document.querySelector("#count").innerHTML=g()}renderProductDetails(){document.querySelector("#title").innerHTML+=this.product.Brand.Name,document.querySelector("#brandName").innerHTML=this.product.Brand.Name,document.querySelector("#productName").innerHTML=this.product.NameWithoutBrand,document.querySelector("#productImage").src=this.product.Images.PrimaryLarge,document.querySelector("#productImage").alt=this.product.Name,document.querySelector(".product-card__price").innerHTML+=this.product.FinalPrice,document.querySelector(".product__color").innerHTML=m(this.product),document.querySelector(".product__description").innerHTML=this.product.DescriptionHtmlSimple;const e=l(this.product.SuggestedRetailPrice,this.product.FinalPrice),t=document.querySelector(".product-card__og-price");e===0?t.classList.add("hide"):t.innerHTML+=this.product.SuggestedRetailPrice.toFixed(2)}}
